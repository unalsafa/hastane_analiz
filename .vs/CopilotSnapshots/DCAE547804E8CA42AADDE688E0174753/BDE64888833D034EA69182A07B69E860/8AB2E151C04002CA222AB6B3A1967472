from dataclasses import dataclass
from typing import Callable, Optional, List
import pandas as pd

from hastane_analiz.etl.transformers.acil import transform_acil
from hastane_analiz.etl.transformers.wide_to_long import transform_wide_to_long


@dataclass
class TransformerEntry:
    fn: Callable[[pd.DataFrame, Optional[str]], pd.DataFrame]
    sayfa_adi: Optional[str] = None


# kategori -> list of TransformerEntry. Aynı kategori içinde birden çok sayfa desteklenir
TRANSFORMER_REGISTRY: dict[str, List[TransformerEntry]] = {
    "ACIL": [
        TransformerEntry(fn=transform_acil, sayfa_adi="ACIL"),
    ],
    "DOGUM": [
        TransformerEntry(fn=transform_wide_to_long, sayfa_adi="DOGUM"),
    ],
    # Yeni kategoriler buraya eklenecek
}
